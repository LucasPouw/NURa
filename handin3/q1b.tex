We choose N log-spaced bins in the range [0, $x_{\rm max}$] such that there are at least 10 galaxies in each bin.

By normalizing 4pi x^2 n(x), we can omit the 4pi, which divides out. This also solves the integration problem for x^(3 - a).

Romberg integrations have order m=6, which keeps computation time low, while providing sufficient accuracy.

We enforce a target fractional accuracy of 1e-8 and a maximum number of 100 iterations.

We apply priors to a and b.

The inital simplex is checked to be non-singular, by computing its volume, using the method on Wikipedia: \url{https://en.wikipedia.org/wiki/Simplex#Volume}. 
A degenerate simplex has zero volume. We set the initial volume threshold at 0.1, because the parameters should change on the order of 0.1 to 1. A piramid 
(just a conceptually simple tetrahedron) with volume 0.1 has base edge width of $(0.1 * 6 \sqrt{2})^{1/3} \approx 0.95$, which seems reasonable to me.

% chi2 uses the model mean as variance, which is very small in the outer empty bins. This therefore puts too much weight here and biases the model upwards.
The number of degrees of freedom is given by $n - k$, where n is the number of bins and $k = 4$ is the number of constraints, which is given by the
number of free parameters (3) and the normalization of the histogram (1).